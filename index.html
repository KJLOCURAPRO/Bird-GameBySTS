<html><head><base href="https://websim.games/" />
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
<title>Flappy Bird - Skins</title>
<style>
  * {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
    user-select: none;
  }
  
  body {
    display: flex;
    justify-content: center;
    align-items: center;
    min-height: 100vh;
    background: #1e90ff;
    font-family: Arial, sans-serif;
    touch-action: none;
    overflow: hidden;
  }

  #game {
    width: 100vw;
    height: 100vh;
    background: linear-gradient(180deg, #87CEEB 0%, #1E90FF 100%);
    position: relative;
    overflow: hidden;
  }

  #bird {
    position: absolute;
    width: 40px;
    height: 40px;
    transform-origin: center;
    z-index: 1000;
  }

  .pipe {
    position: absolute;
    width: 60px;
    background: #2ecc71;
    border: 3px solid #27ae60;
  }

  #score {
    position: fixed;
    top: 20px;
    left: 0;
    right: 0;
    text-align: center;
    font-size: 40px;
    font-weight: bold;
    color: white;
    text-shadow: 2px 2px 4px rgba(0,0,0,0.5);
    z-index: 1000;
  }

  #menu {
    position: fixed;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    text-align: center;
    z-index: 2000;
    background: rgba(0,0,0,0.8);
    padding: 20px;
    border-radius: 10px;
    min-width: 300px;
  }

  .button {
    padding: 15px 30px;
    font-size: 24px;
    background: #f1c40f;
    border: none;
    border-radius: 10px;
    color: #fff;
    cursor: pointer;
    margin: 10px;
    box-shadow: 0 4px 0 #d4ac0d;
    text-shadow: 1px 1px 2px rgba(0,0,0,0.3);
  }

  .button:active {
    transform: translateY(4px);
    box-shadow: none;
  }

  #gameOver {
    display: none;
    color: white;
    font-size: 40px;
    text-shadow: 2px 2px 4px rgba(0,0,0,0.5);
    margin-bottom: 20px;
  }

  .bird-container {
    width: 100%;
    height: 100%;
  }

  #skinSelector {
    display: grid;
    grid-template-columns: repeat(2, 1fr);
    gap: 10px;
    margin: 20px 0;
  }

  .skin-option {
    background: rgba(255,255,255,0.1);
    padding: 10px;
    border-radius: 8px;
    cursor: pointer;
    transition: all 0.3s;
    border: 2px solid transparent;
  }

  .skin-option:hover {
    background: rgba(255,255,255,0.2);
  }

  .skin-option.selected {
    border-color: #f1c40f;
    background: rgba(255,255,255,0.3);
  }

  .skin-preview {
    width: 60px;
    height: 60px;
    margin: 0 auto;
  }

  .skin-name {
    color: white;
    margin-top: 5px;
    font-size: 14px;
  }

  @keyframes flapWings {
    0% { transform: scaleY(1); }
    50% { transform: scaleY(0.9); }
    100% { transform: scaleY(1); }
  }

  .flapping {
    animation: flapWings 0.2s infinite;
  }

  #powerMeter {
    position: fixed;
    top: 70px;
    left: 0;
    right: 0;
    margin: 0 auto;
    width: 200px;
    height: 20px;
    background: rgba(0,0,0,0.5);
    border: 2px solid white;
    border-radius: 10px;
    display: none;
  }

  #powerFill {
    width: 0%;
    height: 100%;
    background: #f1c40f;
    border-radius: 8px;
    transition: width 0.3s linear;
  }

  .power-effect {
    position: absolute;
    pointer-events: none;
    z-index: 999;
  }

  .laser-beam {
    height: 8px;
    background: linear-gradient(90deg, 
        rgba(255,0,0,0.8), 
        rgba(255,128,0,0.8)
    );
    position: absolute;
    transform-origin: left center;
    box-shadow: 
        0 0 10px #ff0000,
        0 0 20px #ff0000,
        0 0 30px #ff0000;
    animation: pulseBeam 0.2s infinite;
  }

  @keyframes pulseBeam {
    0% { opacity: 0.8; height: 8px; }
    50% { opacity: 1; height: 12px; }
    100% { opacity: 0.8; height: 8px; }
  }

  .rainbow-boost {
    width: 40px;
    height: 40px;
    background: linear-gradient(90deg, red, orange, yellow, green, blue, purple);
    opacity: 0.7;
    border-radius: 50%;
    filter: blur(4px);
  }

  .teleport-flash {
    width: 100%;
    height: 100%;
    position: fixed;
    background: rgba(0,0,0,0.3);
    pointer-events: none;
    opacity: 0;
  }

  @keyframes pulse {
    0% { transform: scale(1); opacity: 0.3; }
    50% { transform: scale(1.5); opacity: 0.1; }
    100% { transform: scale(1); opacity: 0.3; }
  }
</style>
</head>
<body>
<div id="game">
  <div id="score">0</div>
  <div id="bird">
    <svg class="bird-container" viewBox="0 0 40 40">
      <!-- El contenido se actualizará según la skin seleccionada -->
    </svg>
  </div>
  <div id="menu">
    <div id="gameOver">¡Game Over!</div>
    <div id="skinSelector">
      <div class="skin-option selected" data-skin="classic">
        <div class="skin-preview">
          <svg viewBox="0 0 40 40">
            <path d="M5,20 Q20,5 35,20 Q20,35 5,20" fill="#FFD700" stroke="#000" stroke-width="2"/>
            <circle cx="30" cy="15" r="2" fill="#000"/>
            <path d="M5,20 L15,15 L5,10" fill="#FF6B6B"/>
          </svg>
        </div>
        <div class="skin-name">Clásico</div>
      </div>
      <div class="skin-option" data-skin="ninja">
        <div class="skin-preview">
          <svg viewBox="0 0 40 40">
            <path d="M5,20 Q20,5 35,20 Q20,35 5,20" fill="#333" stroke="#000" stroke-width="2"/>
            <path d="M15,10 L35,15 L15,20" fill="#f00" stroke="#000"/>
            <circle cx="30" cy="15" r="2" fill="#fff"/>
          </svg>
        </div>
        <div class="skin-name">Ninja</div>
      </div>
      <div class="skin-option" data-skin="robot">
        <div class="skin-preview">
          <svg viewBox="0 0 40 40">
            <rect x="5" y="10" width="30" height="20" fill="#silver" stroke="#000"/>
            <circle cx="30" cy="15" r="3" fill="#00f"/>
            <rect x="2" y="15" width="10" height="5" fill="#gray"/>
          </svg>
        </div>
        <div class="skin-name">Robot</div>
      </div>
      <div class="skin-option" data-skin="rainbow">
        <div class="skin-preview">
          <svg viewBox="0 0 40 40">
            <defs>
              <linearGradient id="rainbow" x1="0%" y1="0%" x2="100%" y2="0%">
                <stop offset="0%" style="stop-color:rgb(255,0,0)"/>
                <stop offset="50%" style="stop-color:rgb(0,255,0)"/>
                <stop offset="100%" style="stop-color:rgb(0,0,255)"/>
              </linearGradient>
            </defs>
            <path d="M5,20 Q20,5 35,20 Q20,35 5,20" fill="url(#rainbow)" stroke="#000" stroke-width="2"/>
            <circle cx="30" cy="15" r="2" fill="#fff"/>
          </svg>
        </div>
        <div class="skin-name">Arcoíris</div>
      </div>
    </div>
    <button class="button" id="startButton">¡Jugar!</button>
  </div>
  <div id="powerMeter">
    <div id="powerFill"></div>
  </div>
</div>

<audio id="jumpSound" src="https://cdn.freesound.org/previews/369/369952_6687454-lq.mp3"></audio>
<audio id="scoreSound" src="https://cdn.freesound.org/previews/135/135936_2514670-lq.mp3"></audio>
<audio id="hitSound" src="https://cdn.freesound.org/previews/178/178876_3370867-lq.mp3"></audio>
<audio id="buttonSound" src="https://cdn.freesound.org/previews/403/403019_5121236-lq.mp3"></audio>

<script>
const game = document.getElementById('game');
const bird = document.getElementById('bird');
const scoreElement = document.getElementById('score');
const menu = document.getElementById('menu');
const gameOverText = document.getElementById('gameOver');
const startButton = document.getElementById('startButton');
const birdSvg = bird.querySelector('.bird-container');
const skinOptions = document.querySelectorAll('.skin-option');

const skins = {
    classic: `
        <path d="M5,20 Q20,5 35,20 Q20,35 5,20" fill="#FFD700" stroke="#000" stroke-width="2"/>
        <circle cx="30" cy="15" r="2" fill="#000"/>
        <path d="M5,20 L15,15 L5,10" fill="#FF6B6B"/>
    `,
    ninja: `
        <path d="M5,20 Q20,5 35,20 Q20,35 5,20" fill="#333" stroke="#000" stroke-width="2"/>
        <path d="M15,10 L35,15 L15,20" fill="#f00" stroke="#000"/>
        <circle cx="30" cy="15" r="2" fill="#fff"/>
    `,
    robot: `
        <rect x="5" y="10" width="30" height="20" fill="silver" stroke="#000"/>
        <circle cx="30" cy="15" r="3" fill="#00f"/>
        <rect x="2" y="15" width="10" height="5" fill="gray"/>
    `,
    rainbow: `
        <defs>
            <linearGradient id="rainbow_bird" x1="0%" y1="0%" x2="100%" y2="0%">
                <stop offset="0%" style="stop-color:rgb(255,0,0)"/>
                <stop offset="50%" style="stop-color:rgb(0,255,0)"/>
                <stop offset="100%" style="stop-color:rgb(0,0,255)"/>
            </linearGradient>
        </defs>
        <path d="M5,20 Q20,5 35,20 Q20,35 5,20" fill="url(#rainbow_bird)" stroke="#000" stroke-width="2"/>
        <circle cx="30" cy="15" r="2" fill="#fff"/>
    `
};

let currentSkin = 'classic';
let isPowerActive = false;

// Sonidos
const jumpSound = document.getElementById('jumpSound');
const scoreSound = document.getElementById('scoreSound');
const hitSound = document.getElementById('hitSound');
const buttonSound = document.getElementById('buttonSound');

jumpSound.volume = 0.2;
scoreSound.volume = 0.2;
hitSound.volume = 0.2;
buttonSound.volume = 0.2;

let powerMeter = document.getElementById('powerMeter');
let powerFill = document.getElementById('powerFill');
let powerCharge = 0;
let canUsePower = true;

const POWER_COOLDOWNS = {
  robot: 10000,
  rainbow: 7000,
  ninja: 5000
};

const POWER_CHARGE_RATE = 0.5;

let gameRunning = false;
let score = 0;
let birdY = window.innerHeight / 2;
let birdX = window.innerWidth / 3;
let velocity = 0;
let pipes = [];
let gameLoop;
let lastTime = 0;
const gravity = 0.3;
const jump = -6;
const pipeSpeed = 3;
const pipeSpawnInterval = 1500;
let lastPipeSpawn = 0;

skinOptions.forEach(option => {
    option.addEventListener('click', () => {
        skinOptions.forEach(opt => opt.classList.remove('selected'));
        option.classList.add('selected');
        currentSkin = option.dataset.skin;
        birdSvg.innerHTML = skins[currentSkin];
    });
});

function init() {
    bird.style.left = `${birdX}px`;
    bird.style.top = `${birdY}px`;
    birdSvg.innerHTML = skins[currentSkin];
    window.addEventListener('click', handleClick);
    window.addEventListener('touchstart', handleClick);
    startButton.addEventListener('click', () => {
        buttonSound.play().catch(e => console.log("Error playing sound:", e));
        startGame();
    });
}

function handleClick(e) {
    e.preventDefault();
    if (gameRunning) {
        velocity = jump;
        birdSvg.classList.add('flapping');
        setTimeout(() => birdSvg.classList.remove('flapping'), 100);
        jumpSound.currentTime = 0;
        jumpSound.play().catch(e => console.log("Error reproduciendo sonido:", e));
    }
}

function startGame() {
    gameRunning = true;
    score = 0;
    scoreElement.textContent = score;
    birdY = window.innerHeight / 2;
    velocity = 0;
    pipes = [];
    powerMeter.style.display = 'block';
    powerCharge = 0;
    updatePowerMeter();
    menu.style.display = 'none';
    gameOverText.style.display = 'none';
    birdSvg.innerHTML = skins[currentSkin];
    clearInterval(gameLoop);
    lastTime = performance.now();
    requestAnimationFrame(update);
}

function createPipe() {
    const gap = 170;
    const minHeight = 50;
    const maxHeight = window.innerHeight - gap - minHeight;
    const upperHeight = Math.floor(Math.random() * (maxHeight - minHeight) + minHeight);
    
    const upperPipe = document.createElement('div');
    upperPipe.className = 'pipe';
    upperPipe.style.height = `${upperHeight}px`;
    upperPipe.style.top = '0';
    
    const lowerPipe = document.createElement('div');
    lowerPipe.className = 'pipe';
    lowerPipe.style.height = `${window.innerHeight - upperHeight - gap}px`;
    lowerPipe.style.bottom = '0';
    
    game.appendChild(upperPipe);
    game.appendChild(lowerPipe);
    
    return {
        x: window.innerWidth,
        upperPipe,
        lowerPipe,
        passed: false,
        upperHeight,
        gap
    };
}

function update(currentTime) {
    if (!gameRunning) return;

    const deltaTime = currentTime - lastTime;
    lastTime = currentTime;

    velocity += gravity;
    birdY += velocity;
    bird.style.top = `${birdY}px`;
    
    const rotation = Math.min(Math.max(-velocity * 3, -30), 30);
    bird.style.transform = `rotate(${-rotation}deg)`;

    if (currentTime - lastPipeSpawn > pipeSpawnInterval) {
        pipes.push(createPipe());
        lastPipeSpawn = currentTime;
    }

    for (let i = pipes.length - 1; i >= 0; i--) {
        const pipe = pipes[i];
        pipe.x -= pipeSpeed;
        
        pipe.upperPipe.style.left = `${pipe.x}px`;
        pipe.lowerPipe.style.left = `${pipe.x}px`;

        if (checkCollision(pipe)) {
            hitSound.play().catch(e => console.log("Error reproduciendo sonido:", e));
            gameOver();
            return;
        }

        if (!pipe.passed && pipe.x < birdX - 20) {
            score++;
            scoreElement.textContent = score;
            pipe.passed = true;
            scoreSound.currentTime = 0;
            scoreSound.play().catch(e => console.log("Error reproduciendo sonido:", e));
        }

        if (pipe.x < -60) {
            game.removeChild(pipe.upperPipe);
            game.removeChild(pipe.lowerPipe);
            pipes.splice(i, 1);
        }
    }

    if (birdY < 0 || birdY > window.innerHeight - 40) {
        hitSound.play().catch(e => console.log("Error reproduciendo sonido:", e));
        gameOver();
        return;
    }

    if (gameRunning && powerCharge < 100 && !isPowerActive) {
        powerCharge += POWER_CHARGE_RATE;
        updatePowerMeter();
    }

    requestAnimationFrame(update);
}

function checkCollision(pipe) {
    const birdRect = {
        left: birdX + 5,
        right: birdX + 35,
        top: birdY + 5,
        bottom: birdY + 35
    };

    const upperPipeRect = {
        left: pipe.x,
        right: pipe.x + 60,
        top: 0,
        bottom: pipe.upperHeight
    };

    const lowerPipeRect = {
        left: pipe.x,
        right: pipe.x + 60,
        top: pipe.upperHeight + pipe.gap,
        bottom: window.innerHeight
    };

    return checkRectCollision(birdRect, upperPipeRect) || 
           checkRectCollision(birdRect, lowerPipeRect);
}

function checkRectCollision(rect1, rect2) {
    return rect1.left < rect2.right && 
           rect1.right > rect2.left && 
           rect1.top < rect2.bottom && 
           rect1.bottom > rect2.top;
}

function gameOver() {
    gameRunning = false;
    menu.style.display = 'block';
    gameOverText.style.display = 'block';
    pipes.forEach(pipe => {
        game.removeChild(pipe.upperPipe);
        game.removeChild(pipe.lowerPipe);
    });
    pipes = [];
    powerMeter.style.display = 'none';
}

function updatePowerMeter() {
    powerFill.style.width = `${powerCharge}%`;
}

function usePower() {
    if (!canUsePower || powerCharge < 100) return;
  
    canUsePower = false;
    powerCharge = 0;
    updatePowerMeter();

    switch(currentSkin) {
        case 'robot':
            shootLaser();
            break;
        case 'ninja':
            ninjaInvincibility();
            break;
        case 'rainbow':
            rainbowBoost();
            break;
    }

    setTimeout(() => {
        canUsePower = true;
    }, POWER_COOLDOWNS[currentSkin]);
}

function ninjaInvincibility() {
    isPowerActive = true;
    bird.style.opacity = '0.5';
    
    const glowEffect = document.createElement('div');
    glowEffect.style.cssText = `
        position: absolute;
        width: 60px;
        height: 60px;
        background: rgba(255,0,0,0.3);
        border-radius: 50%;
        pointer-events: none;
        animation: pulse 1s infinite;
    `;
    bird.appendChild(glowEffect);
    
    const originalCheckCollision = checkCollision;
    checkCollision = () => false;
    
    setTimeout(() => {
        isPowerActive = false;
        bird.style.opacity = '1';
        bird.removeChild(glowEffect);
        checkCollision = originalCheckCollision;
    }, 5000);
}

function shootLaser() {
    const laser = document.createElement('div');
    laser.className = 'laser-beam power-effect';
    laser.style.left = `${birdX + 40}px`;
    laser.style.top = `${birdY + 20}px`;
    laser.style.width = '1000px';
    game.appendChild(laser);
    
    pipes.forEach(pipe => {
        if (pipe.x > birdX && pipe.x < birdX + 1000) {
            game.removeChild(pipe.upperPipe);
            game.removeChild(pipe.lowerPipe);
            pipes = pipes.filter(p => p !== pipe);
        }
    });

    setTimeout(() => game.removeChild(laser), 200);
}

function rainbowBoost() {
    const boost = document.createElement('div');
    boost.className = 'rainbow-boost power-effect';
    game.appendChild(boost);
  
    const originalSpeed = velocity;
    velocity = -25;

    const trails = [];
    for(let i = 0; i < 3; i++) {
        const trail = document.createElement('div');
        trail.className = 'rainbow-boost power-effect';
        trail.style.opacity = `${0.3 - (i * 0.1)}`;
        game.appendChild(trail);
        trails.push(trail);
    }
  
    const boostInterval = setInterval(() => {
        boost.style.left = `${birdX - 20}px`;
        boost.style.top = `${birdY}px`;
        
        trails.forEach((trail, i) => {
            trail.style.left = `${birdX - 40 - (i * 20)}px`;
            trail.style.top = `${birdY}px`;
        });
    }, 16);
  
    setTimeout(() => {
        clearInterval(boostInterval);
        game.removeChild(boost);
        trails.forEach(trail => game.removeChild(trail));
    }, 1000);
}

document.addEventListener('touchmove', (e) => e.preventDefault(), { passive: false });
document.addEventListener('gesturestart', (e) => e.preventDefault());
document.addEventListener('gesturechange', (e) => e.preventDefault());
document.addEventListener('gestureend', (e) => e.preventDefault());

window.addEventListener('keydown', (e) => {
    if (e.code === 'Space' && gameRunning) {
        usePower();
    }
});

let lastTapTime = 0;
window.addEventListener('touchstart', (e) => {
    const currentTime = new Date().getTime();
    const tapLength = currentTime - lastTapTime;
    if (tapLength < 300 && tapLength > 0) {
        usePower();
    }
    lastTapTime = currentTime;
});

init();
</script>
</body>
</html>